<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>CRUISEMANAGER - Dashboard</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

<style>
[sec\:authorize="hasAuthority('ROLE_ADMIN')"] .card-header {
	background: linear-gradient(90deg, #0d6efd, #198754);
}

[sec\:authorize="hasAuthority('ROLE_USER')"] .card-header {
	background: linear-gradient(90deg, #0d6efd, #ffb703);
}

body {
	background: linear-gradient(135deg, #f0f4f9, #d9e4f5);
	font-family: "Poppins", sans-serif;
}

.card {
	border-radius: 1rem;
	box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
	overflow: hidden;
	transition: transform 0.3s;
	margin-bottom: 1.5rem;
	height: 100%;
}

.card:hover {
	transform: translateY(-5px);
	box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.card-header {
	background: linear-gradient(90deg, #0d6efd, #20c997);
	color: white;
	font-weight: 600;
	letter-spacing: 1px;
	padding: 0.8rem 1rem;
	font-size: 1rem;
	text-align: center;
}

.card-body {
	text-align: center;
	padding: 1.5rem 0.5rem;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
}

.card-body i {
	font-size: 2rem;
	color: #0d6efd;
	margin-bottom: 0.5rem;
}

.counter {
	font-size: 1.8rem;
	font-weight: 700;
	margin-top: 0.5rem;
}

.card-text {
	font-size: 0.9rem;
	color: #555;
	margin-bottom: 0;
}

/* Layout de 4 columnas fijas */
.dashboard-grid {
	display: flex;
	flex-wrap: wrap;
	gap: 1.5rem;
	justify-content: flex-start;
}

.col-dashboard {
	flex: 0 0 calc(25% - 1.125rem); /* 25% menos el espacio del gap */
	display: flex;
}

.dashboard-link {
	display: block;
	width: 100%;
	text-decoration: none;
	color: inherit;
}

/* Responsive */
@media (max-width: 1200px) {
	.col-dashboard {
		flex: 0 0 calc(50% - 0.75rem); /* 2 columnas en tablets */
	}
}

@media (max-width: 768px) {
	.col-dashboard {
		flex: 0 0 100%; /* 1 columna en m√≥viles */
	}
	
	.dashboard-grid {
		gap: 1rem;
	}
}

.card {
	border: 1px solid rgba(0, 0, 0, 0.05);
}
</style>
</head>
<body>

	<div class="alert alert-info text-center mt-3">
		<strong>Usuario:</strong> <span sec:authentication="name"></span> | 
		<strong>Rol:</strong> <span sec:authentication="principal.authorities"></span>
	</div>

	<h4 class="text-center mb-4">
		<span sec:authorize="hasAuthority('ROLE_ADMIN')">Panel del Administrador üß≠</span> 
		<span sec:authorize="hasAuthority('ROLE_USER')">Panel del Operador üë®‚Äçüíº</span>
	</h4>

	<div class="text-end m-3">
		<form th:action="@{/logout}" method="post">
			<button type="submit" class="btn btn-danger btn-sm">
				<i class="fas fa-sign-out-alt"></i> Cerrar sesi√≥n
			</button>
		</form>
	</div>

	<div class="container my-4">
		<div class="dashboard-grid"> <!-- Grid personalizado -->

			<!-- Fila 1 -->
			<!-- Usuarios (solo ADMIN) -->
			<div class="col-dashboard" sec:authorize="hasAuthority('ROLE_ADMIN')">
				<a th:href="@{/usuarios}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Registrar Usuarios</div>
						<div class="card-body">
							<i class="fas fa-user"></i>
							<div class="counter" th:text="${totalUsuarios}">0</div>
							<p class="card-text">Total de usuarios</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Modelos de Barco (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/modelos-barco}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Modelos de Barco</div>
						<div class="card-body">
							<i class="fas fa-ship"></i>
							<div class="counter" th:text="${totalModelosBarco}">0</div>
							<p class="card-text">Modelos registrados</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Navieras (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/navieras}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Navieras</div>
						<div class="card-body">
							<i class="fas fa-building"></i>
							<div class="counter" th:text="${totalNavieras}">0</div>
							<p class="card-text">Navieras registradas</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Barcos (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/barcos}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Barcos</div>
						<div class="card-body">
							<i class="fas fa-anchor"></i>
							<div class="counter" th:text="${totalBarcos}">0</div>
							<p class="card-text">Barcos registrados</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Fila 2 -->
			<!-- Ciudades (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/ciudades}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Ciudades</div>
						<div class="card-body">
							<i class="fas fa-city"></i>
							<div class="counter" th:text="${totalCiudades}">0</div>
							<p class="card-text">Ciudades registradas</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Puertos (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/puertos}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Puertos</div>
						<div class="card-body">
							<i class="fas fa-map-marker-alt"></i>
							<div class="counter" th:text="${totalPuertos}">0</div>
							<p class="card-text">Puertos registrados</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Programar Cruceros (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/cruceros}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Programar Cruceros</div>
						<div class="card-body">
							<i class="fas fa-calendar-alt"></i>
							<div class="counter" th:text="${totalCruceros}">0</div>
							<p class="card-text">Cruceros programados</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Pasajeros (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/pasajeros}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Pasajeros</div>
						<div class="card-body">
							<i class="fas fa-users"></i>
							<div class="counter" th:text="${totalPasajeros}">0</div>
							<p class="card-text">Pasajeros registrados</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Fila 3 -->
			<!-- Reservas (ADMIN y USER) -->
			<div class="col-dashboard" sec:authorize="hasAnyAuthority('ROLE_ADMIN','ROLE_USER')">
				<a th:href="@{/reservas}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Reservas</div>
						<div class="card-body">
							<i class="fas fa-ticket-alt"></i>
							<div class="counter" th:text="${totalReservas}">0</div>
							<p class="card-text">Reservas realizadas</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Reportes PDF (solo ADMIN) -->
			<div class="col-dashboard" sec:authorize="hasAuthority('ROLE_ADMIN')">
				<a th:href="@{/reportes/pdf}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Reportes PDF</div>
						<div class="card-body">
							<i class="fas fa-file-pdf"></i>
							<p class="card-text">Generar reportes PDF</p>
						</div>
					</div>
				</a>
			</div>

			<!-- Exportar Excel (solo ADMIN) -->
			<div class="col-dashboard" sec:authorize="hasAuthority('ROLE_ADMIN')">
				<a th:href="@{/reportes/excel}" class="dashboard-link">
					<div class="card">
						<div class="card-header">Excel</div>
						<div class="card-body">
							<i class="fas fa-file-excel"></i>
							<p class="card-text">Exportar a Excel</p>
						</div>
					</div>
				</a>
			</div>

		</div>
	</div>

	<script>
		document.addEventListener("DOMContentLoaded", () => {
		    function animateCounter(element, target) {
		        let count = 0;
		        let increment = target / 100;
		        let interval = setInterval(() => {
		            count += increment;
		            if (count >= target) {
		                count = target;
		                clearInterval(interval);
		            }
		            element.textContent = Math.floor(count);
		        }, 15);
		    }

		    document.querySelectorAll(".counter").forEach(counter => {
		        let target = parseInt(counter.textContent);
		        counter.textContent = "0";
		        animateCounter(counter, target);
		    });
		});
	</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>